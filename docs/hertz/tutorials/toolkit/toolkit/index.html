<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>hz toolkit usage | CloudWeGo</title><meta name=description content="A leading practice for building enterprise cloud native middleware!"><meta property="og:title" content="hz toolkit usage"><meta property="og:description" content="hz is a tool provided by the Hertz framework for generating code. Currently, hz can generate scaffolding for Hertz projects based on thrift and protobuf&rsquo;s IDL.
Install  Make sure the GOPATH environment variable has been defined correctly (eg export GOPATH=~/go) and add $GOPATH/bin to the PATH environment (eg export PATH=$GOPATH/bin:$PATH); do not set GOPATH to a directory that the current user does not have read/write access to. Install hz:  go install github."><meta property="og:type" content="article"><meta property="og:url" content="/docs/hertz/tutorials/toolkit/toolkit/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2022-07-15T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-29T15:07:58+08:00"><meta property="og:site_name" content="CloudWeGo"><meta itemprop=name content="hz toolkit usage"><meta itemprop=description content="hz is a tool provided by the Hertz framework for generating code. Currently, hz can generate scaffolding for Hertz projects based on thrift and protobuf&rsquo;s IDL.
Install  Make sure the GOPATH environment variable has been defined correctly (eg export GOPATH=~/go) and add $GOPATH/bin to the PATH environment (eg export PATH=$GOPATH/bin:$PATH); do not set GOPATH to a directory that the current user does not have read/write access to. Install hz:  go install github."><meta itemprop=datePublished content="2022-07-15T00:00:00+00:00"><meta itemprop=dateModified content="2022-07-29T15:07:58+08:00"><meta itemprop=wordCount content="3962"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="hz toolkit usage"><meta name=twitter:description content="hz is a tool provided by the Hertz framework for generating code. Currently, hz can generate scaffolding for Hertz projects based on thrift and protobuf&rsquo;s IDL.
Install  Make sure the GOPATH environment variable has been defined correctly (eg export GOPATH=~/go) and add $GOPATH/bin to the PATH environment (eg export PATH=$GOPATH/bin:$PATH); do not set GOPATH to a directory that the current user does not have read/write access to. Install hz:  go install github."><script async src="https://www.googletagmanager.com/gtag/js?id=G-QYWRQRLPRM"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QYWRQRLPRM')</script><link rel=preload href=/scss/main.min.d201674178e955a8bd21626117358837295708ba1a2b6c81323efdc76010c4b9.css as=style><link href=/scss/main.min.d201674178e955a8bd21626117358837295708ba1a2b6c81323efdc76010c4b9.css rel=stylesheet integrity><script src=https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','G-QYWRQRLPRM','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand-xl navbar-dark td-navbar"><a class=navbar-brand href=/><span class=navbar-logo><img src=/img/logo.png></span></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#main_navbar aria-controls=main_navbar aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0 ml-auto"><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Documentation</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/kitex/>Kitex</a>
<a class=dropdown-item href=/docs/hertz/>Hertz</a>
<a class=dropdown-item href=/docs/netpoll/>Netpoll</a></div></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/community/><span>Community</span></a></li><li class="dropdown sub-menu"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><span>Security</span></a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/security/safety-bulletin/>safety-bulletin</a>
<a class=dropdown-item href=/security/vulnerability-reporting/>vulnerability-reporting</a></div></li><li class="nav-item dropdown mr-4"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/toolkit/toolkit/>中文</a></div></li></ul></div><div class="navbar-nav d-none d-lg-block"></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><div id=content-mobile><form class="td-sidebar__search d-flex align-items-center"><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form></div><div id=content-desktop></div><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh/docs/hertz/tutorials/toolkit/toolkit/>中文</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docs-li><a href=/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-docs><span>Documentation</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertz-li><a href=/docs/hertz/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertz><span>Hertz</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzoverview-li><a href=/docs/hertz/overview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzoverview><span>Overview</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzgetting-started-li><a href=/docs/hertz/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzgetting-started><span>Getting Started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorials-li><a href=/docs/hertz/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorials><span>Tutorials</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsexample-li><a href=/docs/hertz/tutorials/example/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsexample><span>Example code</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-feature-li><a href=/docs/hertz/tutorials/basic-feature/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-feature><span>Basic Feature</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurenetwork-lib-li><a href=/docs/hertz/tutorials/basic-feature/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurenetwork-lib><span>Network Lib</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsbasic-featuremiddleware-li><a href=/docs/hertz/tutorials/basic-feature/middleware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsbasic-featuremiddleware><span>Middleware Overview</span></a><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarecors-li><a href=/docs/hertz/tutorials/basic-feature/middleware/cors/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarecors><span>CORS</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth-li><a href=/docs/hertz/tutorials/basic-feature/middleware/basic-auth/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarebasic-auth><span>Basic Auth</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuremiddlewarejwt-li><a href=/docs/hertz/tutorials/basic-feature/middleware/jwt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuremiddlewarejwt><span>JWT</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureprotocol-li><a href=/docs/hertz/tutorials/basic-feature/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureprotocol><span>Protocol</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurebinding-and-validate-li><a href=/docs/hertz/tutorials/basic-feature/binding-and-validate/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurebinding-and-validate><span>Binding and validate</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurestream-li><a href=/docs/hertz/tutorials/basic-feature/stream/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurestream><span>Stream</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureerror-handle-li><a href=/docs/hertz/tutorials/basic-feature/error-handle/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureerror-handle><span>Error Handle</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featurelog-li><a href=/docs/hertz/tutorials/basic-feature/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featurelog><span>Log</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featuregraceful-shutdown-li><a href=/docs/hertz/tutorials/basic-feature/graceful-shutdown/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featuregraceful-shutdown><span>Graceful Shutdown</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureforward-proxy-li><a href=/docs/hertz/tutorials/basic-feature/forward-proxy/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureforward-proxy><span>Forward Proxy</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsbasic-featureunit-test-li><a href=/docs/hertz/tutorials/basic-feature/unit-test/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsbasic-featureunit-test><span>Unit Test</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsservice-governance-li><a href=/docs/hertz/tutorials/service-governance/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsservice-governance><span>Service Governance</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsservice-governancemonitoring-li><a href=/docs/hertz/tutorials/service-governance/monitoring/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governancemonitoring><span>Monitoring</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsservice-governancetracing-li><a href=/docs/hertz/tutorials/service-governance/tracing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsservice-governancetracing><span>Tracing</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-exten-li><a href=/docs/hertz/tutorials/framework-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-exten><span>Framework Extension</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenmonitor-li><a href=/docs/hertz/tutorials/framework-exten/monitor/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenmonitor><span>Monitoring Extension</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenlog-li><a href=/docs/hertz/tutorials/framework-exten/log/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenlog><span>Logger Extension</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertztutorialsframework-extenadvanced-exten-li><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialsframework-extenadvanced-exten><span>Advanced Extensions</span></a><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib-li><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/network-lib/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extennetwork-lib><span>Network Library Extensions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialsframework-extenadvanced-extenprotocol-li><a href=/docs/hertz/tutorials/framework-exten/advanced-exten/protocol/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialsframework-extenadvanced-extenprotocol><span>Protocol extension</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-docshertztutorialstoolkit-li><a href=/docs/hertz/tutorials/toolkit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertztutorialstoolkit><span>hz command line tool</span></a><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-docshertztutorialstoolkittoolkit-li><a href=/docs/hertz/tutorials/toolkit/toolkit/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkittoolkit><span class=td-sidebar-nav-active-item>hz toolkit usage</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertztutorialstoolkittemplate-li><a href=/docs/hertz/tutorials/toolkit/template/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertztutorialstoolkittemplate><span>hz custom template use</span></a></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-docshertzreference-li><a href=/docs/hertz/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-docshertzreference><span>Reference</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceconfig-li><a href=/docs/hertz/reference/config/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceconfig><span>Configuration instruction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferenceversion-li><a href=/docs/hertz/reference/version/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferenceversion><span>Version Descriptions</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-docshertzreferencejson-li><a href=/docs/hertz/reference/json/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-docshertzreferencejson><span>JSON Marshal Library</span></a></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/cloudwego/cloudwego.github.io/edit/main/content/en/docs/hertz/tutorials/toolkit/toolkit.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/new/main/content/en/docs/hertz/tutorials/toolkit/toolkit.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/cloudwego/cloudwego.github.io/issues/new?title=hz%20toolkit%20usage" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/cloudwego/kitex/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#install>Install</a></li><li><a href=#operating-mode>Operating mode</a></li><li><a href=#usage>Usage</a><ul><li><a href=#basic-usage>Basic Usage</a></li><li><a href=#create-a-project-based-on-thrift-idl>Create a project based on thrift IDL</a></li><li><a href=#create-a-project-based-on-protobuf-idl>Create a project based on protobuf IDL</a></li><li><a href=#the-structure-of-the-generated-code>The structure of the generated code</a></li><li><a href=#supported-api-annotations>Supported api annotations</a></li><li><a href=#command-line-parameter-description>Command line parameter description</a></li></ul></li><li><a href=#notes>Notes</a><ul><li><a href=#notes-on-using-protobuf-idl>Notes on using protobuf IDL</a></li><li><a href=#notes-on-using-thrift-idl>Notes on using thrift IDL</a></li><li><a href=#description-of-the-behavior-when-using-the-update-command>Description of the behavior when using the update command</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=/docs/>Documentation</a></li><li class=breadcrumb-item><a href=/docs/hertz/>Hertz</a></li><li class=breadcrumb-item><a href=/docs/hertz/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=/docs/hertz/tutorials/toolkit/>hz command line tool</a></li><li class="breadcrumb-item active" aria-current=page><a href=/docs/hertz/tutorials/toolkit/toolkit/>hz toolkit usage</a></li></ol></nav><div class=td-content><h1>hz toolkit usage</h1><header class=article-meta></header><p>hz is a tool provided by the Hertz framework for generating code. Currently, hz can generate scaffolding for Hertz projects based on thrift and protobuf&rsquo;s IDL.</p><h2 id=install>Install</h2><ol><li>Make sure the <code>GOPATH</code> environment variable has been defined correctly (eg <code>export GOPATH=~/go</code>) and add <code>$GOPATH/bin</code> to the PATH environment (eg <code>export PATH=$GOPATH/bin:$PATH</code>); do not set <code>GOPATH</code> to a directory that the current user does not have read/write access to.</li><li>Install hz:</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go install github.com/cloudwego/hertz/cmd/hz@latest
</code></pre></div><ol start=3><li>Verify that the installation was successful <code>hz -v</code>, if the following version message is displayed, the installation was successful</li></ol><pre><code class=language-console data-lang=console>hz version v0.1.0
</code></pre><p><strong>Note</strong>，Since hz creates soft links to its own binary, make sure that the installation path of hz has writable permissions.</p><h2 id=operating-mode>Operating mode</h2><p>To generate code using thrift or protobuf IDL, The corresponding compiler needs to be installed: <a href=https://github.com/cloudwego/thriftgo>thriftgo</a> or <a href=https://github.com/protocolbuffers/protobuf/releases>protoc</a>.</p><p>The code generated by hz, part of it is generated by the underlying compiler (usually about the struct defined in IDL), and the other part is the user-defined routing, method and other information in IDL. The user can run the code directly.</p><p>In terms of execution flow, when hz uses thrift IDL to generate code, hz calls thriftgo to generate the go struct code and executes itself as a plugin to thriftgo (named thrift-gen-hertz) to generate the rest of the code. This is also true when used with the protobuf IDL.</p><pre><code>$&gt; hz  ... --idl=IDL
    |
    | thrift-IDL
    |---------&gt; thriftgo --gen go:... -plugin=hertz:... IDL
    |
    | protobuf-IDL
     ---------&gt; protoc --hertz_out=... --hertz_opt=... IDL
</code></pre><p>How to install thriftgo/protoc:</p><p>thriftgo:</p><pre><code>$ GO111MODULE=on go install github.com/cloudwego/thriftgo@latest
</code></pre><p>protoc:</p><pre><code>// brew installation
$ brew install protobuf

// Official image installation, using macos as an example
$ wget https://github.com/protocolbuffers/protobuf/releases/download/v3.19.4/protoc-3.19.4-osx-x86_64.zip
$ unzip protoc-3.19.4-osx-x86_64.zip
$ cp bin/protoc /usr/local/bin/protoc
// Make sure include/google goes under /usr/local/include
$ cp -r include/google /usr/local/include/google
</code></pre><h2 id=usage>Usage</h2><h3 id=basic-usage>Basic Usage</h3><h4 id=new-create-a-new-hertz-project>new: Create a new Hertz project</h4><ol><li>Create a new project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>// Execute under GOPATH, go mod name defaults to the current path relative to GOPATH, or you can specify your own
hz new

// Execute under non-GOPATH, you need to specify the go mod name
hz new -mod hertz/demo

// Tidy <span style=color:#000;font-weight:700>&amp;</span> get dependencies
go mod tidy
</code></pre></div><p>After executed, it generates a scaffold for the Hertz project in the current directory.</p><ol start=2><li>Compiling Projects</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go build
</code></pre></div><ol start=3><li>Run the project and test it</li></ol><p>Run the project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./<span style=color:#ce5c00;font-weight:700>{{</span>your binary<span style=color:#ce5c00;font-weight:700>}}</span>
</code></pre></div><p>Test:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl 127.0.0.1:8888/ping
</code></pre></div><p>If it returns <code>{"message":"pong"}</code>, it works.</p><h3 id=create-a-project-based-on-thrift-idl>Create a project based on thrift IDL</h3><h4 id=new-create-a-new-project>new: Create a new project</h4><ol><li>Create the thrift IDL file in the current directory</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#8f5902;font-style:italic>// idl/hello.thrift
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hello.example</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Name</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#8f5902;font-style:italic>// Add api annotations for easier parameter binding
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RespBody</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloService</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloMethod</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><ol start=2><li>Create a new project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>// Execute under GOPATH
hz new -idl idl/hello.thrift

// Tidy <span style=color:#000;font-weight:700>&amp;</span> get dependencies
go mod tidy
</code></pre></div><ol start=3><li>Modify the handler and add your own logic</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#8f5902;font-style:italic>// handler path: biz/handler/hello/example/hello_service.go
</span><span style=color:#8f5902;font-style:italic>// where &#34;hello/example&#34; is the namespace of thrift IDL
</span><span style=color:#8f5902;font-style:italic>// &#34;hello_service.go&#34; is the name of the service in the thrift IDL, all methods defined by the service will be generated in this file
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>// HelloMethod .
</span><span style=color:#8f5902;font-style:italic>// @router /hello [GET]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>HelloMethod</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
        <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloReq</span>
        <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
        <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
                <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
                <span style=color:#204a87;font-weight:700>return</span>
        <span style=color:#000;font-weight:700>}</span>

        <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span>

        <span style=color:#8f5902;font-style:italic>// You can modify the logic of the entire function, not just the current template
</span><span style=color:#8f5902;font-style:italic></span>        <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RespBody</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hello,&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Name</span> <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>
        <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><ol start=4><li>Compile the project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go build
</code></pre></div><ol start=5><li>Run the project and test it</li></ol><p>Run the project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./<span style=color:#ce5c00;font-weight:700>{{</span>your binary<span style=color:#ce5c00;font-weight:700>}}</span>
</code></pre></div><p>Test:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl --location --request GET <span style=color:#4e9a06>&#39;http://127.0.0.1:8888/hello?name=hertz&#39;</span>
</code></pre></div><p>If it returns <code>{"RespBody":"hello,hertz"}</code>, it works.</p><h4 id=update-update-an-existing-project>update: Update an existing project</h4><ol><li>If your thrift IDL is updated, for example:</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#8f5902;font-style:italic>// idl/hello.thrift
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hello.example</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Name</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>RespBody</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OtherReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Other</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.body</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;other&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OtherResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Resp</span><span style=color:#000;font-weight:700>;</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloService</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloMethod</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>OtherResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OtherMethod</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OtherReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.post</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/other&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NewService</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>NewMethod</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/new&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><ol start=2><li>Switch to the directory where the new command was executed and update the modified thrift IDL</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hz update -idl idl/hello.thrift
</code></pre></div><ol start=3><li><p>As you can see</p><p>Add new method under &ldquo;biz/handler/hello/example/hello_service.go&rdquo;<br>The file &ldquo;new_service.go&rdquo; and the corresponding &ldquo;NewMethod&rdquo; method have been added under &ldquo;biz/handler/hello/example&rdquo;</p></li></ol><p>Now let&rsquo;s develop the &ldquo;OtherMethod&rdquo; interface</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#8f5902;font-style:italic>// HelloMethod .
</span><span style=color:#8f5902;font-style:italic>// @router /hello [GET]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>HelloMethod</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloReq</span>
   <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
      <span style=color:#204a87;font-weight:700>return</span>
   <span style=color:#000;font-weight:700>}</span>

   <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span>

   <span style=color:#8f5902;font-style:italic>// You can modify the logic of the entire function, not just the current template
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RespBody</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hello,&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Name</span> <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>
   <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>// OtherMethod .
</span><span style=color:#8f5902;font-style:italic>// @router /other [POST]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>OtherMethod</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
   <span style=color:#8f5902;font-style:italic>// The model file corresponding to example.OtherReq will also be regenerated
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OtherReq</span>
   <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
      <span style=color:#204a87;font-weight:700>return</span>
   <span style=color:#000;font-weight:700>}</span>

   <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>example</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OtherResp</span><span style=color:#000;font-weight:700>)</span>

   <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resp</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Other method: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Other</span>

   <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><ol start=4><li>Compile the project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go build
</code></pre></div><ol start=5><li>Run the project and test it</li></ol><p>Run the project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./<span style=color:#ce5c00;font-weight:700>{{</span>your binary<span style=color:#ce5c00;font-weight:700>}}</span>
</code></pre></div><p>Test：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl --location --request POST <span style=color:#4e9a06>&#39;http://127.0.0.1:8888/other&#39;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--header <span style=color:#4e9a06>&#39;Content-Type: application/json&#39;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--data-raw <span style=color:#4e9a06>&#39;{
</span><span style=color:#4e9a06>    &#34;Other&#34;: &#34;other method&#34;
</span><span style=color:#4e9a06>}&#39;</span>
</code></pre></div><p>If it returns <code>{"Resp":"Other method: other method"}</code>, it works.</p><h3 id=create-a-project-based-on-protobuf-idl>Create a project based on protobuf IDL</h3><h4 id=new-create-a-new-project-1>new: Create a new project</h4><ol><li><p>Create the protobuf IDL file in the current directory</p><p><em>Note</em>: In order to support api annotations in protobuf, please import the following file in the proto file where the annotation is used</p></li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#8f5902;font-style:italic>// idl/api.proto; Annotation extension
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>syntax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;proto2&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>api</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;google/protobuf/descriptor.proto&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/api&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>extend</span> <span style=color:#000>google</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>protobuf.FieldOptions</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>raw_body</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50101</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>query</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50102</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>header</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50103</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>cookie</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50104</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>body</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50105</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>path</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50106</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>vd</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50107</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>form</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50108</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>go_tag</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>51001</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>js_conv</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50109</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>extend</span> <span style=color:#000>google</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>protobuf.MethodOptions</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>get</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50201</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>post</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50202</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>put</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50203</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>delete</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50204</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>patch</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50205</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>options</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50206</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>head</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50207</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>any</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50208</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>gen_path</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50301</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>api_version</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50302</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>tag</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50303</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50304</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>api_level</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50305</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>serializer</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50306</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>param</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50307</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>baseurl</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50308</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>extend</span> <span style=color:#000>google</span><span style=color:#ce5c00;font-weight:700>.</span><span style=color:#000>protobuf.EnumValueOptions</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>optional</span> <span style=color:#204a87;font-weight:700>int32</span> <span style=color:#000>http_code</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>50401</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></code></pre></div><p>Main IDL definition</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#8f5902;font-style:italic>// idl/hello/hello.proto
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>syntax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;proto3&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>hello</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hertz/hello&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;api.proto&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>HelloReq</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.query</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>HelloResp</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>RespBody</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>HelloService</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>Method1</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>HelloReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>    <span style=color:#204a87;font-weight:700>option</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></code></pre></div><ol start=2><li>Create a new project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>// Execute under GOPATH, <span style=color:#204a87;font-weight:700>if</span> the dependencies of the main IDL and the main IDL are not in the same path, you need to add the -I option, its meaning is IDL search path, equivalent to the option <span style=color:#4e9a06>&#34;-I&#34;</span> <span style=color:#204a87;font-weight:700>for</span> protoc
hz new -I idl -idl idl/hello/hello.proto

// Tidy <span style=color:#000;font-weight:700>&amp;</span> get dependencies
go mod tidy
</code></pre></div><ol start=3><li>Modify the handler and add your own logic</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#8f5902;font-style:italic>// handler path: biz/handler/hello/hello_service.go
</span><span style=color:#8f5902;font-style:italic>// where &#34;/hello&#34; is the last level of go_package in protobuf IDL
</span><span style=color:#8f5902;font-style:italic>// &#34;hello_service.go&#34; is the name of the service in protobuf IDL, all methods defined by the service will be generated in this file
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>// Method1 .
</span><span style=color:#8f5902;font-style:italic>// @router /hello [GET]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Method1</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloReq</span>
   <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
      <span style=color:#204a87;font-weight:700>return</span>
   <span style=color:#000;font-weight:700>}</span>

   <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span>

   <span style=color:#8f5902;font-style:italic>// You can modify the logic of the entire function, not just the current template
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RespBody</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hello,&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Name</span> <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>
   <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><ol start=4><li>Compile the project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go build
</code></pre></div><ol start=5><li>Run the project and test it</li></ol><p>Run the project：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./<span style=color:#ce5c00;font-weight:700>{{</span>your binary<span style=color:#ce5c00;font-weight:700>}}</span>
</code></pre></div><p>Test：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl --location --request GET <span style=color:#4e9a06>&#39;http://127.0.0.1:8888/hello?name=hertz&#39;</span>
</code></pre></div><p>If it returns <code>{"RespBody":"hello,hertz"}</code>, it works.</p><h4 id=update-update-an-existing-hertz-project>update: Update an existing Hertz project</h4><ol><li>If your protobuf IDL is updated, for example:</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#8f5902;font-style:italic>// idl/hello/hello.proto
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#000>syntax</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;proto3&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>package</span> <span style=color:#000>hello</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hertz/hello&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>import</span> <span style=color:#4e9a06>&#34;api.proto&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>HelloReq</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Name</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.query</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;name&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>HelloResp</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>RespBody</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>OtherReq</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Other</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.body</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;other&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>OtherResp</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Resp</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>HelloService</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>Method1</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>HelloReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>    <span style=color:#204a87;font-weight:700>option</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>Method2</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>OtherReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>OtherResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>    <span style=color:#204a87;font-weight:700>option</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>api.post</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/other&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>NewService</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>Method3</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>OtherReq</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>OtherResp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>    <span style=color:#204a87;font-weight:700>option</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/new&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></code></pre></div><ol start=2><li>Switch to the directory where the new command was executed and update the modified IDL</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hz update -I idl -idl idl/hello/hello.proto
</code></pre></div><ol start=3><li><p>As you can see</p><p>Add new method under &ldquo;biz/handler/hello/hello_service.go&rdquo;<br>The file &ldquo;new_service.go&rdquo; and the corresponding &ldquo;Method3&rdquo; method have been added under &ldquo;biz/handler/hello&rdquo;</p></li></ol><p>Now let&rsquo;s develop the &ldquo;Method2&rdquo; interface</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=color:#8f5902;font-style:italic>// Method1 .
</span><span style=color:#8f5902;font-style:italic>// @router /hello [GET]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Method1</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloReq</span>
   <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
      <span style=color:#204a87;font-weight:700>return</span>
   <span style=color:#000;font-weight:700>}</span>

   <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>HelloResp</span><span style=color:#000;font-weight:700>)</span>

   <span style=color:#8f5902;font-style:italic>// You can modify the logic of the entire function, not just the current template
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RespBody</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hello,&#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Name</span> <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>
   <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#8f5902;font-style:italic>// Method2 .
</span><span style=color:#8f5902;font-style:italic>// @router /other [POST]
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>func</span> <span style=color:#000>Method2</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>ctx</span> <span style=color:#000>context</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Context</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>c</span> <span style=color:#ce5c00;font-weight:700>*</span><span style=color:#000>app</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>RequestContext</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>err</span> <span style=color:#204a87;font-weight:700>error</span>
   <span style=color:#204a87;font-weight:700>var</span> <span style=color:#000>req</span> <span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OtherReq</span>
   <span style=color:#000>err</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>BindAndValidate</span><span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>req</span><span style=color:#000;font-weight:700>)</span>
   <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000>err</span> <span style=color:#ce5c00;font-weight:700>!=</span> <span style=color:#204a87;font-weight:700>nil</span> <span style=color:#000;font-weight:700>{</span>
      <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>String</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>400</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>err</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Error</span><span style=color:#000;font-weight:700>())</span>
      <span style=color:#204a87;font-weight:700>return</span>
   <span style=color:#000;font-weight:700>}</span>

   <span style=color:#000>resp</span> <span style=color:#ce5c00;font-weight:700>:=</span> <span style=color:#204a87>new</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hello</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>OtherResp</span><span style=color:#000;font-weight:700>)</span>

   <span style=color:#8f5902;font-style:italic>// added logic
</span><span style=color:#8f5902;font-style:italic></span>   <span style=color:#000>resp</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Resp</span> <span style=color:#000;font-weight:700>=</span> <span style=color:#4e9a06>&#34;Other method: &#34;</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>req</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>Other</span>

   <span style=color:#000>c</span><span style=color:#000;font-weight:700>.</span><span style=color:#000>JSON</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>200</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>resp</span><span style=color:#000;font-weight:700>)</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><ol start=4><li>Compile the project</li></ol><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>go build
</code></pre></div><ol start=5><li>Run the project and test it</li></ol><p>Run the project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>./<span style=color:#ce5c00;font-weight:700>{{</span>your binary<span style=color:#ce5c00;font-weight:700>}}</span>
</code></pre></div><p>Test：</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl --location --request POST <span style=color:#4e9a06>&#39;http://127.0.0.1:8888/other&#39;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--header <span style=color:#4e9a06>&#39;Content-Type: application/json&#39;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>--data-raw <span style=color:#4e9a06>&#39;{
</span><span style=color:#4e9a06>    &#34;Other&#34;: &#34;other method&#34;
</span><span style=color:#4e9a06>}&#39;</span>
</code></pre></div><p>If it returns <code>{"Resp":"Other method: other method"}</code>, it works.</p><h3 id=the-structure-of-the-generated-code>The structure of the generated code</h3><p>The structure of the code generated by hz is similar. The following is an example of the structure of the code generated by the section &ldquo;Create a project based on thrift IDL&rdquo; to illustrate the meaning of the code generated by hz.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>.
├── biz                                // business layer, which stores business logic related processes
│   ├── handler                        // store handler file
│   │   ├── hello                      // hello/example corresponds to the namespace defined in thrift IDL<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>for</span> protobuf IDL, it corresponds to the last level of go_package
│   │   │   └── example
│   │   │       ├── hello_service.go   // the handler file, the user will implement the method defined by the IDL service in this file, it will search <span style=color:#204a87;font-weight:700>for</span> the existing handler in the current file when <span style=color:#4e9a06>&#34;update&#34;</span> command, and append a new handler to the end
│   │   │       └── new_service.go     // same as above, each service defined in IDL corresponds to a file
│   │   └── ping.go                    // ping handler carried by default, used to generate code <span style=color:#204a87;font-weight:700>for</span> quick debugging, no other special meaning
│   ├── model                          // IDL content-related generation code
│   │   └── hello                      // hello/example corresponds to the namespace defined in thrift IDL<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>for</span> protobuf IDL, it corresponds to the last level of go_package
│   │     └── example
│   │         └── hello.go             // the product of thriftgo, It contains go code generated from the contents of hello.thrift definition. And it will be regenerated when use <span style=color:#4e9a06>&#34;update&#34;</span> command.
│   └── router                         // generated code related to the definition of routes in IDL
│       ├── hello                      // hello/example corresponds to the namespace defined in thrift IDL<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>for</span> protobuf IDL, it corresponds to the last level of go_package
│       │   └── example
│       │       ├── hello.go           // the route registration code generated <span style=color:#204a87;font-weight:700>for</span> the routes defined in hello.thrift by hz<span style=color:#000;font-weight:700>;</span> this file will be regenerated each <span style=color:#204a87>time</span> the relevant IDL is updated
│       │       └── middleware.go      // default middleware <span style=color:#204a87;font-weight:700>function</span>, hz adds a middleware <span style=color:#204a87;font-weight:700>for</span> each generated route group by default<span style=color:#000;font-weight:700>;</span> when updating, it will look <span style=color:#204a87;font-weight:700>for</span> the existing middleware in the current file and append new middleware at the end
│       └── register.go                // call and register the routing definition in each IDL file<span style=color:#000;font-weight:700>;</span> when a new IDL is added, the call of its routing registration will be automatically inserted during the update<span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>do</span> not edit
├── go.mod                             // go.mod file, <span style=color:#204a87;font-weight:700>if</span> not specified on the <span style=color:#204a87>command</span> line, defaults to a relative path to GOPATH as the module name
├── idl                                // user defined IDL, location can be arbitrary
│   └── hello.thrift
├── main.go                            // program entry
├── router.go                          // user defined routing methods other than IDL
└── router_gen.go                      // the route registration code generated by hz, <span style=color:#204a87;font-weight:700>for</span> calling user-defined routes and routes generated by hz
</code></pre></div><h3 id=supported-api-annotations>Supported api annotations</h3><blockquote><p>Field annotation can be used for<a href=https://www.cloudwego.io/docs/hertz/tutorials/basic-feature/binding-and-validate/>parameter binding and validation</a></p><p>Method annotation can be used to generate code that related to route registration</p></blockquote><h4 id=supported-api-annotations-1>Supported api annotations</h4><table><thead><tr><th><em>Field annotation</em></th><th></th></tr></thead><tbody><tr><td>annotation</td><td>description</td></tr><tr><td>api.raw_body</td><td>generate &ldquo;raw_body&rdquo; tag</td></tr><tr><td>api.query</td><td>generate &ldquo;query&rdquo; tag</td></tr><tr><td>api.header</td><td>generate &ldquo;header&rdquo; tag</td></tr><tr><td>api.cookie</td><td>generate &ldquo;cookie&rdquo; tag</td></tr><tr><td>api.body</td><td>generate &ldquo;json&rdquo; tag</td></tr><tr><td>api.path</td><td>generate &ldquo;path&rdquo; tag</td></tr><tr><td>api.form</td><td>generate &ldquo;form&rdquo; tag</td></tr><tr><td>api.go_tag (protobuf)<br>go.tag (thrift)</td><td>passing go_tag through will generate the content defined in go_tag</td></tr><tr><td>api.vd</td><td>generate &ldquo;vd&rdquo; tag</td></tr></tbody></table><table><thead><tr><th><em>Method annotation</em></th><th></th></tr></thead><tbody><tr><td>annotation</td><td>description</td></tr><tr><td>api.get</td><td>define GET methods and routes</td></tr><tr><td>api.post</td><td>define POST methods and routes</td></tr><tr><td>api.put</td><td>define PUT methods and routes</td></tr><tr><td>api.delete</td><td>define DELETE methods and routes</td></tr><tr><td>api.patch</td><td>define PATCH methods and routes</td></tr><tr><td>api.options</td><td>define OPTIONS methods and routes</td></tr><tr><td>api.head</td><td>define HEAD methods and routes</td></tr><tr><td>api.any</td><td>define ANY methods and routes</td></tr></tbody></table><h4 id=usage-1>Usage:</h4><h5 id=field-annotation>Field annotation:</h5><p>Thrift:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#204a87;font-weight:700>struct</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Demo</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Demo</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.query</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;demo&#34;</span><span style=color:#000;font-weight:700>,</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>api.path</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;demo&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>GoTag</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>go.tag</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;goTag:&#34;</span><span style=color:#000>tag</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>string</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Vd</span> <span style=color:#ce5c00;font-weight:700>(</span><span style=color:#000>api.vd</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;$!=&#39;your string&#39;&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>Protobuf:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#204a87;font-weight:700>message</span> <span style=color:#000>Demo</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Demo</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.query</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;demo&#34;</span><span style=color:#000;font-weight:700>,(</span><span style=color:#000>api.path</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;demo&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>GoTag</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.go_tag</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;goTag:&#34;</span><span style=color:#000>tag</span><span style=color:#4e9a06>&#34;&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>string</span> <span style=color:#000>Vd</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>[(</span><span style=color:#000>api.vd</span><span style=color:#000;font-weight:700>)</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;$!=&#39;your string&#39;&#34;</span><span style=color:#000;font-weight:700>];</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></code></pre></div><h5 id=method-annotation>Method annotation:</h5><p>Thrift:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Demo</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>Resp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Method</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Req</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/route&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>Protobuf:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#204a87;font-weight:700>service</span> <span style=color:#000>Demo</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#204a87;font-weight:700>rpc</span> <span style=color:#000>Method</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Req</span><span style=color:#000;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>returns</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>Resp</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span><span style=color:#a40000>
</span><span style=color:#a40000></span>    <span style=color:#204a87;font-weight:700>option</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#000;font-weight:700>)</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;/route&#34;</span><span style=color:#000;font-weight:700>;</span><span style=color:#a40000>
</span><span style=color:#a40000></span>  <span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span><span style=color:#a40000></span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>
</span></code></pre></div><h3 id=command-line-parameter-description>Command line parameter description</h3><h4 id=global>Global:</h4><pre><code class=language-console data-lang=console>$ hz --help
NAME:
   hz - A idl parser and code generator for Hertz projects

USAGE:
   hz [global options] command [command options] [arguments...]

VERSION:
   0.0.1

COMMANDS:
   new      Generate a new Hertz project
   update   Update an existing Hertz project
   help, h  Shows a list of commands or help for one command

GLOBAL OPTIONS:
   --help, -h     show help (default: false)
   --verbose      turn on verbose mode (default: false)
   --version, -v  print the version (default: false)
</code></pre><ul><li>new: Create a new Hertz project</li></ul><ul><li>update: Updating an existing Hertz project</li></ul><h4 id=new>New:</h4><pre><code class=language-console data-lang=console>$ hz help new
NAME:
   hz new - Generate a new Hertz project

USAGE:
   hz new [command options] [arguments...]

OPTIONS:
   --client_dir value                Specify the client path. If not specified, no client code is generated.
   --customize_layout value          Specify the layout template. ({{Template Profile}}:{{Rendering Data}})
   --customize_package value         Specify the package template. ({{Template Profile}}:)
   --exclude_file value, -E value    Specify the files that do not need to be updated.  (accepts multiple inputs)
   --handler_dir value               Specify the handler path.
   --idl value                       Specify the IDL file path. (.thrift or .proto)  (accepts multiple inputs)
   --json_enumstr                    Use string instead of num for json enums when idl is thrift. (default: false)
   --model_dir value                 Specify the model path.
   --module value, --mod value       Specify the Go module name to generate go.mod.
   --no_recurse                      Generate master model only. (default: false)
   --option_package value, -P value  Specify the package path. ({include_path}={import_path})  (accepts multiple inputs)
   --out_dir value                   Specify the project path.
   --proto_path value, -I value      Add an IDL search path for includes. (Valid only if idl is protobuf)  (accepts multiple inputs)
   --protoc value, -p value          Specify arguments for the protoc. ({flag}={value})                    (accepts multiple inputs)
   --service value                   Specify the service name.
   --snake_tag                       Use snake_case style naming for tags. (Only works for 'form', 'query', 'json') (default: false)
   --thriftgo value, -t value        Specify arguments for the thriftgo. ({flag}={value})  (accepts mul
</code></pre><ul><li>client_dir: Specify the path to generate client-side code, if not specified, it will not be generated; currently generates a global client for each service, and will provide rich client code capabilities later</li></ul><ul><li>customize_layout: Customize the layout template of the project. For details, see: <a href=https://www.cloudwego.io/docs/hertz/tutorials/toolkit/template/>hz custom template use</a></li></ul><ul><li>customize_package: Customize the project package related templates, mainly for the handler template. For details, see: <a href=https://www.cloudwego.io/docs/hertz/tutorials/toolkit/template/>hz custom template use</a></li></ul><ul><li>exclude_file: Files that do not need to be updated(relative to the project path, multiple supported)</li></ul><ul><li>handler_dir: Specify the handler generation path, the default is &ldquo;biz/handler&rdquo;</li></ul><ul><li>idl: IDL file path (.thrift or .proto)</li></ul><ul><li>json_enumstr: When IDL is thrift, json enums uses string instead of num (option passed through to thriftgo)</li></ul><ul><li>model_dir: Specify the model generation path, the default is &ldquo;biz/model&rdquo;</li></ul><ul><li>module/mod: Specify the name of go mod, which must be specified under non-GOPATH, and default to a path relative to GOPATH under GOPATH.</li></ul><ul><li>no_recurse: Generate only the model code for main IDL</li></ul><ul><li>option_package/P: Specify the path to the package, ({include_path}={import_path})</li></ul><ul><li>out_dir: Specify the project build path</li></ul><ul><li>proto_path/I: When IDL is protobuf, specify the search path for IDL, equivalent to the option &ldquo;-I&rdquo; for protoc</li></ul><ul><li>protoc/p: Option passed through to protoc ({flag}={value})</li></ul><ul><li>service: Service name, reserved for later service discovery and other functions</li></ul><ul><li>snake_tag: The tag is named in snake_case style(only works for form、query、json )</li></ul><ul><li>thriftgo/t: Option passwd through to thrift ({flag}={value})</li></ul><ul><li>unset_omitempty: When IDL is protobuf, the model field is generated and the omitempty tag is removed; when IDL is thrift, whether to add omitempty is determined by whether the field is &ldquo;optional&rdquo; or &ldquo;required&rdquo;</li></ul><h4 id=update>Update:</h4><pre><code class=language-console data-lang=console>$ hz help update
NAME:
   hz update - Update an existing Hertz project

USAGE:
   hz update [command options] [arguments...]

OPTIONS:
   --client_dir value                Specify the client path. If not specified, no client code is generated.
   --customize_package value         Specify the package template. ({{Template Profile}}:)
   --exclude_file value, -E value    Specify the files that do not need to be updated.  (accepts multiple inputs)
   --handler_dir value               Specify the handler path.
   --idl value                       Specify the IDL file path. (.thrift or .proto)  (accepts multiple inputs)
   --json_enumstr                    Use string instead of num for json enums when idl is thrift. (default: false)
   --model_dir value                 Specify the model path.
   --no_recurse                      Generate master model only. (default: false)
   --option_package value, -P value  Specify the package path. ({include_path}={import_path})  (accepts multiple inputs)
   --out_dir value                   Specify the project path.
   --proto_path value, -I value      Add an IDL search path for includes. (Valid only if idl is protobuf)  (accepts multiple inputs)
   --protoc value, -p value          Specify arguments for the protoc. ({flag}={value})                    (accepts multiple inputs)
   --snake_tag                       Use snake_case style naming for tags. (Only works for 'form', 'query', 'json') (default: false)
   --thriftgo value, -t value        Specify arguments for the thriftgo. ({flag}={value})  (accepts multiple inputs)
   --unset_omitempty                 Remove 'omitempty' tag for generated struct. (default: false)
</code></pre><ul><li>client_dir: Specify the path to generate client-side code, if not specified, it will not be generated; currently generates a global client for each service, and will provide rich client code capabilities later. Note: If you update the same set of IDL, the value of client_dir needs to be the same as when using new, otherwise it will generate redundant code that needs to be removed by the user.</li></ul><ul><li>customize_package: Customize the project package related templates, mainly for the handler template. For details, see:<a href=https://www.cloudwego.io/docs/hertz/tutorials/toolkit/template/>hz custom template use</a>. Note: For an existing handler file, a handler function will be added according to the default template, and for handler files that do not exist yet, a handler will be generated according to a custom template.</li></ul><ul><li>exclude_file: Files that do not need to be updated(relative to the project path, multiple supported)</li></ul><ul><li>handler_dir: Specify the handler generation path, the default is &ldquo;biz/handler&rdquo;; Note: If you update the same set of IDL, the value of handler_dir needs to be the same as when using new, otherwise it will generate redundant code that needs to be removed by the user.</li></ul><ul><li>idl: IDL file path (.thrift or .proto)</li></ul><ul><li>json_enumstr: When IDL is thrift, json enums uses string instead of num (option passed through to thriftgo)</li></ul><ul><li>model_dir: Specify the model generation path, the default is &ldquo;biz/model&rdquo;; Note: If you update the same set of IDL, the value of model_dir needs to be the same as when using new, otherwise it will generate redundant code that needs to be removed by the user.</li></ul><ul><li>no_recurse: Generate only the model code for main IDL</li></ul><ul><li>option_package/P: Specify the path to the package, ({include_path}={import_path})</li></ul><ul><li>out_dir: Specify the project build path</li></ul><ul><li>proto_path/I: When IDL is protobuf, specify the search path for IDL, same as protoc&rsquo;s -I command</li></ul><ul><li>protoc/p: Option passed through to protoc ({flag}={value})</li></ul><ul><li>snake_tag: The tag is named in snake_case style(only works for form、query、json )</li></ul><ul><li>thriftgo/t: Option passwd through to thrift ({flag}={value})</li></ul><ul><li>unset_omitempty: When IDL is protobuf, the model field is generated and the omitempty tag is removed; when IDL is thrift, whether to add omitempty is determined by whether the field is &ldquo;optional&rdquo; or &ldquo;required&rdquo;</li></ul><h2 id=notes>Notes</h2><h3 id=notes-on-using-protobuf-idl>Notes on using protobuf IDL</h3><p>hz currently supports the syntax of <a href=https://developers.google.com/protocol-buffers/docs/proto>proto2</a> / <a href=https://developers.google.com/protocol-buffers/docs/proto3>proto3</a></p><p><strong>We hope that users specify go_package when defining the protobuf IDL</strong>, so that one is consistent with the semantics of protobuf and the location of the generated model can be determined by go_package. If the user does not specify go_package, hz will default the package of the proto file to go_package, which may have some unintended naming conflicts.</p><p>For example, go_package can be defined like this</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-protobuf data-lang=protobuf><span style=color:#204a87;font-weight:700>option</span> <span style=color:#000>go_package</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#4e9a06>&#34;hello.world&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#8f5902;font-style:italic>// or hello/world
</span></code></pre></div><p>The generated path of model will be:</p><p><code>${project path}/${model_dir}/hello/world</code></p><p>The handler file will take the last level of go_package as the generation path, and its generation path will be:</p><p><code>${project path}/${handler_dir}/world</code></p><p>The router registration file will also take the last level of the go_package as the generation path, and the generation path will be:</p><p><code>${project path}/biz/router/world</code></p><h3 id=notes-on-using-thrift-idl>Notes on using thrift IDL</h3><p><strong>hz has no special requirements for the definition of thrift IDL</strong>, it only needs to comply with the grammar specification. The code generation path will be related to the thrift namespace</p><p>For example, a namespace can be defined like this</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hello.world</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p>The generated path of model will be:</p><p><code>${project path}/${model_dir}/hello/world</code></p><p>The handler file will take namespace as the generation path, and its generation path will be:</p><p><code>${project path}/${handler_dir}/hello/world</code></p><p>The router registration file will also take namespace as the generation path, and its generation path will be:</p><p><code>${project path}/biz/router/hello/world</code></p><h3 id=description-of-the-behavior-when-using-the-update-command>Description of the behavior when using the update command</h3><ol><li>Notes on using custom path</li></ol><p>For the convenience of user, hz provides custom handler paths, model paths, templates, etc. However, hz does not save the current project information when creating a new project, so it can be considered as a stateless update when using the update command. Therefore, for the same set of IDL in new and update, using different custom information may result in duplicate code, for example, as follows:</p><p>Create a new project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hz new -idl demo.thrift

// In this <span style=color:#204a87;font-weight:700>case</span>, hz will generate the model under <span style=color:#4e9a06>&#34;biz/model&#34;</span>
</code></pre></div><p>Update an existing project:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>hz update -idl demo.thrift --model_dir<span style=color:#ce5c00;font-weight:700>=</span>my_model

// In this <span style=color:#204a87;font-weight:700>case</span>, hz will not update the model code under <span style=color:#4e9a06>&#34;biz/model&#34;</span>, but under <span style=color:#4e9a06>&#34;my_model&#34;</span><span style=color:#000;font-weight:700>;</span> <span style=color:#204a87;font-weight:700>then</span> the code under <span style=color:#4e9a06>&#34;biz/model&#34;</span> and <span style=color:#4e9a06>&#34;my_model&#34;</span> will be duplicated, and the new handler will depend on <span style=color:#4e9a06>&#34;my_model&#34;</span>,while the previous handler will depend on <span style=color:#4e9a06>&#34;biz/model&#34;</span>. In this <span style=color:#204a87;font-weight:700>case</span>, you need to delete <span style=color:#000;font-weight:700>&amp;</span> change some code manually.
</code></pre></div><p>Therefore, <strong>we hope that user use the update command with custom paths &ldquo;client_dir&rdquo;, &ldquo;model_dir&rdquo;, &ldquo;handler_dir&rdquo;, preferably same as new.</strong></p><ol start=2><li>Behavior of update handler</li></ol><p>hz will generate handlers based on default/custom template when creating a new project, where each service generates a file that contains all the handler code defined by the service; if IDL defines multiple services, each service will generate a file, and these files are in the same path; for example:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-thrift data-lang=thrift><span style=color:#8f5902;font-style:italic>// demo.thrift
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>namespace</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>hello.example</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service1</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Method1</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/hello&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>service</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Service2</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>{</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#000>HelloResp</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Method2</span><span style=color:#ce5c00;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>HelloReq</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>request</span><span style=color:#000;font-weight:700>)</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000;font-weight:700>(</span><span style=color:#000>api.get</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;/new&#34;</span><span style=color:#000;font-weight:700>);</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#000;font-weight:700>}</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#8f5902;font-style:italic>// Then the handler file generated by the IDL is as follows:
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#a40000>$</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>handler_dir</span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>/$</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>namespace</span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>/</span><span style=color:#000>service1.go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#a40000>-</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>method1</span><span style=color:#f8f8f8;text-decoration:underline>
</span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#a40000>$</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>handler_dir</span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>/$</span><span style=color:#000;font-weight:700>{</span><span style=color:#000>namespace</span><span style=color:#000;font-weight:700>}</span><span style=color:#a40000>/</span><span style=color:#000>service2.go</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#a40000>-</span><span style=color:#000;font-weight:700>&gt;</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>method2</span><span style=color:#f8f8f8;text-decoration:underline>
</span></code></pre></div><p><strong>When a new method is added to the IDL, the handler template will be added at the end of the corresponding service file; note that the handler added here will use the default template, and the new service file will use a custom template if appropriate.</strong></p><ol start=3><li>Behavior of update router</li></ol><p>The router code generated by hz in new mainly includes the following three:</p><ul><li>biz/router/${namespace}/${idlName}.go: Each primary IDL generates a corresponding routing registration code file, which registers all the routes defined in the IDL in a routing group, and sets the default middleware.</li></ul><ul><li>biz/router/${namespace}/middleware.go: The default middleware function corresponding to each primary IDL, which can be modified by the user to add specific middleware logic to a particular route.</li></ul><ul><li>biz/router/register.go: This file is responsible for calling the route registration generated by different IDL; for example, if i define service in both IDL &ldquo;demo1.thrift&rdquo; and &ldquo;demo2.thrift&rdquo;, then both files will generate the corresponding route registration code. register.go is responsible for calling the route registration functions of these two parts.</li></ul><p>Based on the above description, a description of the router&rsquo;s behavior during update is given:</p><ul><li>biz/${namespace}/${idlName}.go: Regenerate based on IDL every time, users should not change the code of this file, otherwise the code will be lost.</li></ul><ul><li>biz/${namespace}/middleware.go: Appends a currently unavailable middleware to the end each time.</li></ul><ul><li>biz/router/register.go: If there is a new IDL, the route registration method of the new IDL will be inserted.</li></ul><style>.feedback--answer{display:inline-block}.feedback--answer-no{margin-left:1em}.feedback--response{display:none;margin-top:1em}.feedback--response__visible{display:block}</style><div class=d-print-none><h2 class=feedback--title>Feedback</h2><p class=feedback--question>Was this page helpful?</p><button class="btn btn-primary mb-4 feedback--answer feedback--answer-yes">Yes</button>
<button class="btn btn-primary mb-4 feedback--answer feedback--answer-no">No</button><p class="feedback--response feedback--response-yes"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p><p class="feedback--response feedback--response-no"><a href=https://github.com/cloudwego/cloudwego.github.io/issues/new>Please tell us how we can improve</a>.</p></div><script>const yesButton=document.querySelector('.feedback--answer-yes'),noButton=document.querySelector('.feedback--answer-no'),yesResponse=document.querySelector('.feedback--response-yes'),noResponse=document.querySelector('.feedback--response-no'),disableButtons=()=>{yesButton.disabled=!0,noButton.disabled=!0},sendFeedback=b=>{if(typeof ga!='function')return;const a={command:'send',hitType:'event',category:'Helpful',action:'click',label:window.location.pathname,value:b};ga(a.command,a.hitType,a.category,a.action,a.label,a.value)};yesButton.addEventListener('click',()=>{yesResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(1)}),noButton.addEventListener('click',()=>{noResponse.classList.add('feedback--response__visible'),disableButtons(),sendFeedback(0)})</script><br><div class="text-muted mt-5 pt-3 border-top">Last modified
July 29, 2022
: <a href=https://github.com/cloudwego/cloudwego.github.io/commit/5a731aa00bb34cf7ccff6deb6d2d2d0341214a22>[docs]: translate Custimize Error Handler (#273) (5a731aa)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 The CloudWeGo Authors</small><p class="mt-2 text-white"><a class=cloudwego-link href=/about/ target=_blank rel=noopener>About</a>
|
<a class=cloudwego-link href=https://github.com/cloudwego/cloudwego.github.io/blob/main/LICENSE target=_blank rel=noopener>License</a></p></div></div></div></footer></div><script src=https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.staticfile.org/bootstrap/4.6.0/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=/js/main.min.3728cc033d898893b3f2ed8d48f3f38db8396f66fab99967cee9187fddffd4a7.js integrity="sha256-NyjMAz2JiJOz8u2NSPPzjbg5b2b6uZlnzukYf93/1Kc=" crossorigin=anonymous></script></body></html>